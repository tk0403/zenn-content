---
title: "TiDBã®TTLï¼ˆTime to Liveï¼‰"
emoji: "ðŸŽƒ"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["TiDB"]
published: false
---


# ã¯ã˜ã‚ã«
MySQLã¨äº’æ›æ€§ã®ã‚ã‚‹TiDBã§ã™ãŒã€TiDBç‹¬è‡ªã®æ©Ÿèƒ½ã‚‚å­˜åœ¨ã—ã¾ã™ã€‚
æœ¬è¨˜äº‹ã§ã¯ãã®ã²ã¨ã¤ã§ã‚ã‚‹ï¼ˆå°‘ãªãã¨ã‚‚åŸ·ç­†æ™‚ç‚¹ã«ãŠã„ã¦ã¯ï¼‰TTLæ©Ÿèƒ½ã«ã¤ã„ã¦è¦‹ã¦ã„ãã¾ã™ã€‚

å‚è€ƒï¼šhttps://docs.pingcap.com/tidb/stable/time-to-live

# TTLã®æ©Ÿèƒ½æ¦‚è¦
ä½¿ã„æ‰€ã¨ã—ã¦ã¯ã€DBã«æ°¸ç¶šçš„ã«ä¿å­˜ã—ç¶šã‘ã‚‹å¿…è¦ã®ãªã„ãƒ­ã‚°ãƒ‡ãƒ¼ã‚¿ãªã©ã€ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸è¦³ç‚¹ã§ä¸€å®šã®æ¡ä»¶ã«åŸºã¥ã„ã¦ãƒ‡ãƒ¼ã‚¿ã‚’å‰Šé™¤ã—ãŸã„ã‚ˆã†ãªè¦ä»¶ãŒã‚ã‚‹å ´åˆãªã©ã¨ãªã‚Šã¾ã™ã€‚


TiDBã®TTLã¯
1. ãƒ†ãƒ¼ãƒ–ãƒ«ã®TTLå±žæ€§ã®å®šç¾©ã«åŸºã¥ããƒ¬ã‚³ãƒ¼ãƒ‰ã”ã¨ã®æœ‰åŠ¹æœŸé–“ã‚’å®šã‚
2. ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã‚¸ãƒ§ãƒ–ã§æœ‰åŠ¹æœŸé–“ã‚’ãƒã‚§ãƒƒã‚¯ã—ã€æœŸé™åˆ‡ã‚Œã®ãƒ¬ã‚³ãƒ¼ãƒ‰ã¯å‰Šé™¤ã™ã‚‹
ã¨ã„ã†æ©Ÿèƒ½ã§ã™ã€‚
:::message
æœŸé™åˆ‡ã‚Œã®ãƒ‡ãƒ¼ã‚¿ãŒç›´ã¡ã«å‰Šé™¤ã•ã‚Œã‚‹ã€ã¨ã„ã†ã‚ã‘ã§ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚
TTLã®å¯¾è±¡ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’å‚ç…§ã™ã‚‹ã‚·ãƒŠãƒªã‚ªã«ãŠã„ã¦ã¯whereå¥ã§ã¡ã‚ƒã‚“ã¨æ¡ä»¶æŒ‡å®šã™ã‚‹ãªã©"å‰Šé™¤ã•ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’å‰æã¨ã—ãªã„"ã‚ˆã†ã«ã—ã¾ã—ã‚‡ã†ã€‚
:::


TTLã‚’åˆ©ç”¨ã™ã‚‹å ´åˆã€å…·ä½“çš„ã«ã¯å„ãƒ†ãƒ¼ãƒ–ãƒ«ã”ã¨ã«ä»¥ä¸‹ã®è¨­å®šã‚’å®šç¾©ã—ã¾ã™ã€‚
* `TTL`ï¼šTTLã«ã‚ˆã‚‹å‰Šé™¤å¯¾è±¡ãƒ‡ãƒ¼ã‚¿ã®æ¡ä»¶ã‚’å®šç¾©ã—ã¾ã™ã€‚æ¡ä»¶ã¯æ—¥æ™‚ã«ã‚ˆã‚‹ã‚‚ã®ã‚„ã‚‚ã†å°‘ã—è¤‡é›‘ãªã‚‚ã®ã‚‚å®šç¾©ã§ãã¾ã™ï¼ˆãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆå‚ç…§ï¼‰
* `TTL_ENABLE`ï¼šå½“è©²ãƒ†ãƒ¼ãƒ–ãƒ«ã®TTLã‚¸ãƒ§ãƒ–å®Ÿè¡Œã®æœ‰åŠ¹/ç„¡åŠ¹ã‚’å®šç¾©ã—ã¾ã™ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼š`ON`ï¼‰`OFF`ã®å ´åˆã€TTLã‚¸ãƒ§ãƒ–ã¯å®Ÿè¡Œã•ã‚Œã¾ã›ã‚“ï¼ˆâ‰’å‰Šé™¤ã•ã‚Œã¾ã›ã‚“ï¼‰ã€‚
* `TTL_JOB_INTERVAL`ï¼šå½“è©²ãƒ†ãƒ¼ãƒ–ãƒ«ã«ãŠã‘ã‚‹ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰TTLã‚¸ãƒ§ãƒ–å®Ÿè¡Œé–“éš”ã‚’å®šç¾©ã—ã¾ã™ï¼ˆãƒ‡ãƒ•ã‚©ãƒ«ãƒˆï¼š1hï¼‰

ã¤ã¾ã‚Šã€ã‚¤ãƒ¡ãƒ¼ã‚¸ã¯ä»¥ä¸‹ã®å›³ã®ã‚ˆã†ã«ãªã‚Šã¾ã™ã€‚
![](/images/482b4e94da8c7f/tidb_ttl_image01.png)
å‰Šé™¤å¯¾è±¡ã®æ¡ä»¶ã‚’`created_at`ã§æœ‰åŠ¹æœŸé–“60åˆ†ã¨ã—ã€1æ™‚é–“ã”ã¨ã«TTLãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã‚¸ãƒ§ãƒ–ãŒå®Ÿè¡Œã•ã‚Œã‚‹å ´åˆã®ä¾‹ã§ã™ã€‚â€»2024/4/1 14:00ã‚ˆã‚ŠTTLã‚¸ãƒ§ãƒ–ãŒå®Ÿè¡Œã—ã¦ã„ã‚‹
è‰²åˆ†ã‘ã—ãŸå‰Šé™¤å¯¾è±¡ãƒ‡ãƒ¼ã‚¿ãŒã€åŒè‰²ã®TTLã‚¸ãƒ§ãƒ–å®Ÿè¡Œã®ã‚¿ã‚¤ãƒŸãƒ³ã‚°ã§å‰Šé™¤ã•ã‚Œã¦ã„ãã‚¤ãƒ¡ãƒ¼ã‚¸ã§ã™ã€‚

# ä½¿ã£ã¦ã¿ã‚‹
ãã‚Œã§ã¯ã€å®Ÿéš›ã«TiDBã®TTLæ©Ÿèƒ½ã‚’ä½¿ã£ã¦ã¿ã¾ã—ã‚‡ã†ã€‚
TiDBï¼ˆãƒ­ãƒ¼ã‚«ãƒ« â€»[tiup playground](https://zenn.dev/shigeyuki/articles/8663e1598ecfa5)ï¼‰ã§ç¢ºèªã—ã¾ã™ã€‚
```sql
mysql> SELECT tidb_version()\G
*************************** 1. row ***************************
tidb_version(): Release Version: v7.5.1
Edition: Community
Git Commit Hash: 7d16cc79e81bbf573124df3fd9351c26963f3e70
Git Branch: heads/refs/tags/v7.5.1
UTC Build Time: 2024-02-27 14:21:44
GoVersion: go1.21.6
Race Enabled: false
Check Table Before Drop: false
Store: tikv
1 row in set (0.01 sec)
```

ã¾ãšã€`created_at`ãŒ5åˆ†ãŒæœ‰åŠ¹æœŸé–“ã¨ã—ã¦å®šç¾©ã—ãŸãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œæˆã—ã¾ã™ã€‚
`TTL = created_at + INTERVAL 5 MINUTE`

```sql
CREATE TABLE t1
(   
    `id` bigint NOT NULL AUTO_INCREMENT,
    `created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
    PRIMARY KEY (`id`)
) TTL = `created_at` + INTERVAL 5 MINUTE;
```


ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã ã¨TTLã‚¸ãƒ§ãƒ–å®Ÿè¡Œé–“éš”ï¼ˆ`TTL_JOB_INTERVAL`ï¼‰ãŒ`1h`ã§ã‚ã‚‹ãŸã‚ã€å‹•ä½œç¢ºèªã¨ã—ã¦ã¯é•·ã„ã®ã§çŸ­ãã—ã¾ã™ã€‚
```sql
-- TTL_JOB_INTERVALã‚’å¤‰æ›´
ALTER TABLE t1 TTL_JOB_INTERVAL = '5m';

-- TTL_JOB_INTERVALã‚’ç¢ºèª
mysql> SHOW CREATE TABLE t1;
+-------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| Table | Create Table                                                                                                                                                                                                                                                                                                                                                                                 |
+-------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
| t1    | CREATE TABLE `t1` (
  `id` bigint(20) NOT NULL AUTO_INCREMENT,
  `created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`) /*T![clustered_index] CLUSTERED */
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_bin /*T![ttl] TTL=`created_at` + INTERVAL 5 MINUTE */ /*T![ttl] TTL_ENABLE='ON' */ /*T![ttl] TTL_JOB_INTERVAL='5m' */ |
+-------+----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+
1 row in set (0.00 sec)
```
:::message
ç¾æ™‚ç‚¹ã«ãŠã„ã¦TTLã‚¸ãƒ§ãƒ–å®Ÿè¡Œé–“éš”ï¼ˆ`TTL_JOB_INTERVAL`ï¼‰ã¯ã€
æ—¥(`1d`) / æ™‚é–“ï¼ˆ`1h`ï¼‰ / åˆ†ï¼ˆ`1m`ï¼‰å˜ä½ã§ã®ã¿æŒ‡å®šãŒå¯èƒ½ãªã‚ˆã†ã§ã™ã€‚
https://github.com/pingcap/tidb/pull/40033
:::

ä½•ãƒ¬ã‚³ãƒ¼ãƒ‰ã‹ãƒ†ã‚­ãƒˆãƒ¼ã«INSERTã—ã¾ã™ã€‚
```sql
INSERT INTO t1 VALUES ();
```

ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’ç¢ºèªã—ã¾ã™ã€‚ã¾ã æ¶ˆãˆã¦ã„ã¾ã›ã‚“ã€‚
```sql
mysql> SELECT now();
+---------------------+
| now()               |
+---------------------+
| 2024-05-07 16:56:39 |
+---------------------+
1 row in set (0.01 sec)

mysql> SELECT * FROM t1;
+----+---------------------+
| id | created_at          |
+----+---------------------+
|  1 | 2024-05-07 16:54:07 |
|  2 | 2024-05-07 16:54:14 |
|  3 | 2024-05-07 16:54:26 |
|  4 | 2024-05-07 16:55:48 |
|  5 | 2024-05-07 16:55:55 |
|  6 | 2024-05-07 16:56:12 |
+----+---------------------+
6 rows in set (0.01 sec)
```

ä¸€å®šã®æ™‚é–“çµŒéŽå¾Œã€æ”¹ã‚ã¦ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’ç¢ºèªã—ã¾ã™ã€‚
```sql
mysql> SELECT now();
+---------------------+
| now()               |
+---------------------+
| 2024-05-07 17:00:42 |
+---------------------+
1 row in set (0.00 sec)

mysql> SELECT * FROM t1;
+----+---------------------+
| id | created_at          |
+----+---------------------+
|  4 | 2024-05-07 16:55:48 |
|  5 | 2024-05-07 16:55:55 |
|  6 | 2024-05-07 16:56:12 |
+----+---------------------+
3 rows in set (0.00 sec)
```
å®šç¾©ã—ãŸæœ‰åŠ¹æœŸé–“ã‚’è¶ŠãˆãŸï¼“ãƒ¬ã‚³ãƒ¼ãƒ‰ã¯å‰Šé™¤ã•ã‚Œã¦ã„ã‚‹ã“ã¨ãŒç¢ºèªã§ãã¾ã—ãŸã€‚

# ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰ã®TTLã‚¸ãƒ§ãƒ–å®Ÿè¡Œå±¥æ­´ã®ç¢ºèª
ã¡ãªã¿ã«TTLã‚¸ãƒ§ãƒ–ã®å®Ÿè¡Œå±¥æ­´ã¯ãƒ†ãƒ¼ãƒ–ãƒ«`mysql.tidb_ttl_table_status`ã§ç¢ºèªã§ãã¾ã™ã€‚
```sql
SELECT * FROM mysql.tidb_ttl_table_status ORDER BY last_job_start_time DESC LIMIT 1\G;
```
ä»¥ä¸‹ã®ã‚ˆã†ã«ã€ã‚¸ãƒ§ãƒ–ã®å®Ÿè¡Œæ™‚é–“ã‚„å‰Šé™¤ã•ã‚ŒãŸãƒ¬ã‚³ãƒ¼ãƒ‰æ•°ãªã©ãŒç¢ºèªã§ãã¾ã™ã€‚
```sql
mysql> SELECT * FROM mysql.tidb_ttl_table_status ORDER BY last_job_start_time DESC LIMIT 1\G;
*************************** 1. row ***************************
                      table_id: 102
               parent_table_id: 102
              table_statistics: NULL
                   last_job_id: 4a6cce1643c846edb02aab77feaecf86
           last_job_start_time: 2024-05-07 17:00:02
          last_job_finish_time: 2024-05-07 17:00:08
           last_job_ttl_expire: 2024-05-07 16:55:02
              last_job_summary: {"total_rows":3,"success_rows":3,"error_rows":0,"total_scan_task":1,"scheduled_scan_task":1,"finished_scan_task":1}
                current_job_id: NULL
          current_job_owner_id: NULL
        current_job_owner_addr: NULL
     current_job_owner_hb_time: NULL
        current_job_start_time: NULL
        current_job_ttl_expire: NULL
             current_job_state: NULL
            current_job_status: NULL
current_job_status_update_time: NULL
1 row in set (0.00 sec)
```
`last_job_ttl_expire`ã«è¨˜è¼‰ã•ã‚Œã¦ã„ã‚‹`2024-05-07 16:55:02`ä»¥å‰ã®ãƒ¬ã‚³ãƒ¼ãƒ‰ãŒå‰Šé™¤ã•ã‚Œã¦ã„ã¾ã™ã€‚

# ç•™æ„äº‹é …
ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã«ã‚‚è¨˜è¼‰ã‚ã‚Šã¾ã™ãŒã€ä»¥ä¸‹ã«ã¯ç•™æ„å¿…è¦ã§ã™ã€‚
* TiDB Serverlessã§ã¯ä½¿ãˆãªã„ï¼ˆåŸ·ç­†æ™‚ç‚¹ã«ãŠã„ã¦ã€‚ä»Šå¾Œã‚µãƒãƒ¼ãƒˆäºˆå®šãŒã‚ã‚‹ãã†ã§ã™ï¼‰
* [ä¸€æ™‚ãƒ†ãƒ¼ãƒ–ãƒ«](https://docs.pingcap.com/tidb/stable/temporary-tables)ã§ã¯åˆ©ç”¨ã§ããªã„ï¼ˆãã‚‚ãã‚‚ä¸€æ™‚ãƒ†ãƒ¼ãƒ–ãƒ«ãªã®ã§ä¸€èˆ¬çš„ãªä½¿ã„æ–¹ã®ç¯„ç–‡ã§ã¯TTLä¸è¦ã‹ã¨ï¼‰
* TTLãŒè¨­å®šã•ã‚Œã¦ã„ã‚‹ãƒ†ãƒ¼ãƒ–ãƒ«ã¯ã€å¤–éƒ¨ã‚­ãƒ¼åˆ¶ç´„ã®ä¸»ãƒ†ãƒ¼ãƒ–ãƒ«ã¨ã—ã¦ä»–ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã‹ã‚‰å‚ç…§ã•ã‚Œã‚‹ã“ã¨ã‚’ã‚µãƒãƒ¼ãƒˆã—ã¦ã„ãªã„ï¼ˆâ‰’ä»¥ä¸‹ã®ä¾‹ã®ã‚ˆã†ã«è¦ªãƒ†ãƒ¼ãƒ–ãƒ«ã§ã¯TTLãŒä½¿ãˆãªã„ï¼‰
```sql
-- å¤–éƒ¨ã‚­ãƒ¼åˆ¶ç´„ã®å‚ç…§å…ƒï¼ˆè¦ªãƒ†ãƒ¼ãƒ–ãƒ«ï¼‰ã‚’ä½œæˆ
CREATE TABLE parent(   
    `id` bigint NOT NULL AUTO_INCREMENT,
    `created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
    PRIMARY KEY (`id`));

-- å­ãƒ†ãƒ¼ãƒ–ãƒ«ã‚’ä½œæˆ
CREATE TABLE child (
    `id` BIGINT NOT NULL PRIMARY KEY AUTO_INCREMENT,
    `pid` BIGINT NOT NULL, 
    `name` VARCHAR(64) NOT NULL,
    `created_at` datetime NOT NULL DEFAULT CURRENT_TIMESTAMP,
    INDEX idx_pid (pid),
    FOREIGN KEY (pid) REFERENCES parent(id) ON DELETE CASCADE);

-- è¦ªãƒ†ãƒ¼ãƒ–ãƒ«ã«TTLå±žæ€§ã‚’è¿½åŠ  -> NG
mysql> ALTER TABLE parent TTL = `created_at` + INTERVAL 5 MINUTE;
ERROR 8152 (HY000): Set TTL for a table referenced by foreign key is not allowed

-- å­ãƒ†ãƒ¼ãƒ–ãƒ«ã«TTLå±žæ€§ã‚’è¿½åŠ  -> OK
mysql> ALTER TABLE child TTL = `created_at` + INTERVAL 5 MINUTE;
Query OK, 0 rows affected (0.08 sec)
```

* ä»¥ä¸‹ã®æ¡ä»¶ã‚’æº€ãŸã™ãƒ†ãƒ¼ãƒ–ãƒ«ã®å ´åˆã€TTLã‚¸ãƒ§ãƒ–ã®å®Ÿè¡ŒãŒé…ããªã‚‹å¯èƒ½æ€§ã‚ã‚Šï¼ˆå˜ä¸€ã®TiDBãƒŽãƒ¼ãƒ‰ä¸Šã§é †æ¬¡å®Ÿè¡Œã•ã‚Œã‚‹ãŸã‚ï¼‰
    * [Cluseterd Index](https://docs.pingcap.com/tidb/stable/clustered-indexes)ã®ãƒ†ãƒ¼ãƒ–ãƒ«ã§Primary KeyãŒintã§ã‚‚ãƒã‚¤ãƒŠãƒªã§ã‚‚ãªã„å ´åˆ
* TiDBãƒ„ãƒ¼ãƒ«ã¨ã®å…¼ã­åˆã„ã§ã€ä»¥ä¸‹ã®TiDBã®ãƒ‡ãƒ¼ã‚¿ã¯`TTL_ENABLE`ãŒ`OFF`ã«è¨­å®šã•ã‚Œã‚‹
    * [BR](https://docs.pingcap.com/tidb/stable/backup-and-restore-overview)ï¼ˆãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ï¼†ãƒªã‚¹ãƒˆã‚¢ç”¨ã®ãƒ„ãƒ¼ãƒ«ï¼‰ã«ã‚ˆã‚‹ãƒãƒƒã‚¯ã‚¢ãƒƒãƒ—ã‹ã‚‰ãƒªã‚¹ãƒˆã‚¢ã•ã‚ŒãŸTiDBã®ãƒ‡ãƒ¼ã‚¿
    * [Lightning](https://docs.pingcap.com/tidb/stable/tidb-lightning-overview)ï¼ˆTiDBã¸ã®ãƒ‡ãƒ¼ã‚¿ã‚¤ãƒ³ãƒãƒ¼ãƒˆãƒ„ãƒ¼ãƒ«ï¼‰ã‚’åˆ©ç”¨ã—ã¦ãƒ‡ãƒ¼ã‚¿ã‚’Importã—ãŸTiDBã®ãƒ‡ãƒ¼ã‚¿
    â€» TiDB Cloudã ã¨Importæ©Ÿèƒ½ãŒè©²å½“
    * [TiCDC](https://docs.pingcap.com/tidb/stable/ticdc-overview)ï¼ˆTiDBã‹ã‚‰éžåŒæœŸãƒ¬ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã™ã‚‹ãŸã‚ã®ãƒ„ãƒ¼ãƒ«ï¼‰ã‚’ä½¿ã£ã¦ãƒ¬ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã—ã¦ã„ã‚‹ãƒ€ã‚¦ãƒ³ã‚¹ãƒˆãƒªãƒ¼ãƒ å´ã®TiDBã®ãƒ‡ãƒ¼ã‚¿
    â€»ã‚¢ãƒƒãƒ—ã‚¹ãƒˆãƒªãƒ¼ãƒ å´ã§TTLã«ã‚ˆã‚Šå‰Šé™¤ã•ã‚ŒãŸãƒ‡ãƒ¼ã‚¿ã¯ã€ãƒ¬ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã«ã‚ˆã‚Šãƒ€ã‚¦ãƒ³ã‚¹ãƒˆãƒªãƒ¼ãƒ å´ã§ã‚‚å‰Šé™¤ã•ã‚Œã‚‹ãŸã‚
* [FLASHBACK TABLE](https://docs.pingcap.com/tidb/stable/sql-statement-flashback-table) (DATABASE / CLUSTER)æ©Ÿèƒ½ã‚’åˆ©ç”¨ã—ãŸå ´åˆã€`TTL_ENABLE`ãŒ`OFF`ã«è¨­å®šã•ã‚Œã‚‹


# è£œè¶³ï¼šä»¥å‰ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã§ã®ä»•æ§˜

TTLæ©Ÿèƒ½ã¯TiDBï¼ˆLTSã ã¨ï¼‰v6.5.0ã‹ã‚‰æœ‰åŠ¹ã«ãªã‚Šã¾ã—ãŸã€‚
:::message
[v6.5.xã«ãŠã„ã¦ã¯TTLè‡ªä½“ãŒExperimentalæ©Ÿèƒ½](https://docs.pingcap.com/tidb/v6.5/time-to-live)ã§ã‚ã‚Šå•†ç”¨åˆ©ç”¨ã¯é¿ã‘ã¦ã­ã€ã¨æ›¸ã„ã¦ã‚ã‚Šã¾ã™ã€‚
:::

TiDB v6.5.xã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã«ãŠã„ã¦ã¯ã€TTLå®šç¾©ã¯ãƒ†ãƒ¼ãƒ–ãƒ«å˜ä½ã§ã¯ãªãSystem Variablesã«ã‚ˆã‚‹ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹å˜ä½ã§å…±æœ‰ã®è¨­å®šã ã£ãŸã‚ˆã†ã§ã™ã€‚
â€»ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆç¢ºèªã—ãŸã‚‰minimumã®ã‚¤ãƒ³ã‚¿ãƒ¼ãƒãƒ«ã¯10åˆ†ã§ã—ãŸã€‚
å‚è€ƒï¼š[tidb_ttl_job_run_interval](https://docs.pingcap.com/tidb/v6.5/system-variables#tidb_ttl_job_run_interval-new-in-v650)

```sql
mysql> SELECT tidb_version()\G
*************************** 1. row ***************************
tidb_version(): Release Version: v6.5.5
Edition: Community
Git Commit Hash: 71bcc44f77a37cfb0a6dc3660e092c78c1e46acb
Git Branch: heads/refs/tags/v6.5.5
UTC Build Time: 2023-09-18 10:13:45
GoVersion: go1.19.12
Race Enabled: false
TiKV Min Version: 6.2.0-alpha
Check Table Before Drop: false
Store: tikv
1 row in set (0.00 sec)
```

å‚è€ƒï¼šé–¢é€£ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿
```sql
-- TTL_ENABLEã«ç›¸å½“
mysql> SHOW VARIABLES LIKE 'tidb_ttl_job_enable';
+---------------------+-------+
| Variable_name       | Value |
+---------------------+-------+
| tidb_ttl_job_enable | ON    |
+---------------------+-------+
1 row in set (0.00 sec)

-- TTL_JOB_INTERVALã«ç›¸å½“
mysql> SHOW VARIABLES LIKE 'tidb_ttl_job_run_interval';
+---------------------------+--------+
| Variable_name             | Value  |
+---------------------------+--------+
| tidb_ttl_job_run_interval | 1h0m0s |
+---------------------------+--------+
1 row in set (0.00 sec)
```
